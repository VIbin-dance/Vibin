<head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.0/moment.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment-duration-format/2.2.2/moment-duration-format.js"></script>
</head>
<section id="upload">
  <div class="col-lg-6 m-auto">
    <h1 class="text-center mb-3"><i class="fas fa-user-plus"></i>UPLOAD</h1>
    <%- include ('partials/messages') %>
    <div class="fill">
      <div class="form-group">
        <input type="urlFill" id="urlFill" name="urlFill" class="form-control" placeholder="Enter The URL"
          value="<%= typeof urlFill != 'undefined' ? urlFill : '' %>" />
      </div>
      <div class="text-center">
        <button class="button" onclick="list()">Fill</button>
      </div>
    </div>
    <form action="/upload" method="POST">

      <div class="form-group">
        <label for="title">Title</label>
        <input type="title" id="title" name="title" class="form-control" placeholder="Enter The Title"
          value="<%= typeof title != 'undefined' ? title : '' %>" readonly />
      </div>

      <div class="form-group">
        <label for="thumbnail">Thumbnail</label>
        <input type="thumbnail" id="thumbnail" name="thumbnail" class="form-control" placeholder="Enter The Thumbnail"
          value="<%= typeof thumbnail != 'undefined' ? thumbnail : '' %>" readonly />
      </div>

      <div class="form-group">
        <label for="url">URL</label>
        <input type="url" id="url" name="url" class="form-control" placeholder="Enter The URL"
          value="<%= typeof url != 'undefined' ? url : '' %>" readonly />
      </div>

      <div class="form-group">
        <label for="id">ID</label>
        <input type="id" id="id" name="id" class="form-control" placeholder="Enter The ID"
          value="<%= typeof id != 'undefined' ? id : '' %>" readonly />
      </div>

      <div class="form-group">
        <label for="publishedDate">Date</label>
        <input type="publishedDate" id="publishedDate" name="publishedDate" class="form-control"
          placeholder="Enter The Date" value="<%= typeof publishedDate != 'undefined' ? publishedDate : '' %>"
          readonly />
      </div>

      <div class="form-group">
        <label for="length">Length</label>
        <input type="length" id="length" name="length" class="form-control" placeholder="Enter The Length"
          value="<%= typeof length != 'undefined' ? length : '' %>" readonly />
      </div>

      <div class="form-group">
        <label for="lengthCat">Length Category</label>
        <input type="lengthCat" id="lengthCat" name="lengthCat" class="form-control"
          placeholder="Enter The Length Category" value="<%= typeof lengthCat != 'undefined' ? lengthCat : '' %>"
          readonly />
      </div>

      <div class="form-group" id="languageInput">
        <label for="language">Language</label>
        <input type="language" id="language" name="language" class="form-control" placeholder="Enter The Language"
          value="<%= typeof language != 'undefined' ? language : '' %>" readonly />
      </div>

      <div class="form-group" id="languageDrop" hidden>
        <label for="language">Language</label>
        <select class="form-control" type="language" id="inputState" name="language">
          <option selected="null" value="any">Language</option>
          <option value="ja">Japanese</option>
          <option value="en">English</option>
          <option value="ko">Korean</option>
          <option value="es">Spanish</option>
        </select>
      </div>

      <div class="form-group">
        <label for="choreographer">Choreographer</label>
        <input type="choreographer" id="choreographer" name="choreographer" class="form-control"
          placeholder="Enter The Choreographer"
          value="<%= typeof choreographer != 'undefined' ? choreographer : '' %>" />
      </div>

      <div class="form-group">
        <label for="level">Level</label>
        <fieldset class="form-group">
          <div class="form-check">
            <label class="form-check-label">
              <input id="level" name="level" class="form-check-input" type="checkbox" value="Beginner">Beginner</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="level" name="level" class="form-check-input" class="form-check-input" type="checkbox"
                value="Intermediate">Intermediate</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="level" name="level" class="form-check-input" class="form-check-input" type="checkbox"
                value="Advanced">Advanced</label>
          </div>
      </div>

      <div class="form-group">
        <label for="genre">Genre</label>
        <fieldset class="form-group">
          <div class="form-check">
            <label class="form-check-label">
              <input id="genre" name="genre" class="form-check-input" type="checkbox" value="Hip Hop">Hip
              Hop</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="genre" name="genre" class="form-check-input" class="form-check-input" type="checkbox"
                value="Locking">Locking</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="genre" name="genre" class="form-check-input" class="form-check-input" type="checkbox"
                value="Jazz">Jazz</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="genre" name="genre" class="form-check-input" class="form-check-input" type="checkbox"
                value="Breakin">Breakin</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="genre" name="genre" class="form-check-input" class="form-check-input" type="checkbox"
                value="House">House</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="genre" name="genre" class="form-check-input" class="form-check-input" type="checkbox"
                value="Popping">Popping</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="genre" name="genre" class="form-check-input" class="form-check-input" type="checkbox"
                value="K-POP">K-POP</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="genre" name="genre" class="form-check-input" class="form-check-input" type="checkbox"
                value="TikTok">TikTok</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="genre" name="genre" class="form-check-input" class="form-check-input" type="checkbox"
                value="Bollywood">Bollywood</label>
          </div>
      </div>

      <div class="form-group">
        <label for="purpose">Purpose</label>
        <fieldset class="form-group">
          <div class="form-check">
            <label class="form-check-label">
              <input id="purpose" name="purpose" class="form-check-input" type="checkbox"
                value="Skill Improvements">Skill Improvements</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="purpose" name="purpose" class="form-check-input" class="form-check-input" type="checkbox"
                value="Health and Exercise">Health and Exercise</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="purpose" name="purpose" class="form-check-input" class="form-check-input" type="checkbox"
                value="Entertainment">Entertainment</label>
          </div>
      </div>

      <div class="form-group">
        <label for="mood">Mood</label>
        <fieldset class="form-group">
          <div class="form-check">
            <label class="form-check-label">
              <input id="mood" name="mood" class="form-check-input" type="checkbox" value="Groovy">Groovy</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="mood" name="mood" class="form-check-input" class="form-check-input" type="checkbox"
                value="Funky">Funky</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="mood" name="mood" class="form-check-input" class="form-check-input" type="checkbox"
                value="Chill">Chill</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="mood" name="mood" class="form-check-input" class="form-check-input" type="checkbox"
                value="Romantic">Romantic</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="mood" name="mood" class="form-check-input" class="form-check-input" type="checkbox"
                value="Sexy">Sexy</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="mood" name="mood" class="form-check-input" class="form-check-input" type="checkbox"
                value="Calm">Calm</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="mood" name="mood" class="form-check-input" class="form-check-input" type="checkbox"
                value="Angry">Angry</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="mood" name="mood" class="form-check-input" class="form-check-input" type="checkbox"
                value="Peaceful">Peaceful</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="mood" name="mood" class="form-check-input" class="form-check-input" type="checkbox"
                value="Sad">Sad</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="mood" name="mood" class="form-check-input" class="form-check-input" type="checkbox"
                value="Fearful">Fearful</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="mood" name="mood" class="form-check-input" class="form-check-input" type="checkbox"
                value="Happy">Happy</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="mood" name="mood" class="form-check-input" class="form-check-input" type="checkbox"
                value="Tense">Tense</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="mood" name="mood" class="form-check-input" class="form-check-input" type="checkbox"
                value="Sassy">Sassy</label>
          </div>
          <div class="form-check">
            <label class="form-check-label">
              <input id="mood" name="mood" class="form-check-input" class="form-check-input" type="checkbox"
                value="Savage">Savage</label>
          </div>
      </div>

      <div class="text-center"><button class="button" type="submit">Upload</button></div>
    </form>
  </div>
</section>

<script>
  function list() {
    let url = document.getElementById("urlFill").value
    let id = url.replace('https://www.youtube.com/watch?v=', '');
    let API_key = '<%= API_key %>'

    const urlList = `https://www.googleapis.com/youtube/v3/videos?part=snippet%2CcontentDetails%2Cstatistics&id=${id}&key=${API_key}`

    if (url.includes('&')) {
      let output = url.substring(0, url.lastIndexOf('&list'));

      alert('The URL might be from a playlist. You might have meant ' + output)
    }

    fetch(urlList)
      .then(response => response.json())
      .then(data => {
        console.log(data)
        let duration = moment.duration(data.items[0].contentDetails.duration);

        if (duration._milliseconds > 3600000) {
          document.getElementById("lengthCat").value = 'long';
        } else if (duration._milliseconds > 1200000) {
          document.getElementById("lengthCat").value = 'medium';
        } else {
          document.getElementById("lengthCat").value = 'short';
        }

        document.getElementById("title").value = data.items[0].snippet.title;
        document.getElementById("thumbnail").value = data.items[0].snippet.thumbnails.standard.url;
        document.getElementById("url").value = url;
        document.getElementById("id").value = id;
        document.getElementById("length").value = duration.format('HH:mm:ss', { trim: false });
        document.getElementById("publishedDate").value = data.items[0].snippet.publishedAt;
        if (data.items[0].snippet.defaultLanguage != undefined) {
          document.getElementById("language").value = data.items[0].snippet.defaultLanguage;
          document.getElementById("languageDrop").remove();
        } else if (data.items[0].snippet.defaultLanguage == undefined) {
          document.getElementById("languageDrop").hidden = false;
          document.getElementById("languageInput").remove();
        }
      })
  }
</script>