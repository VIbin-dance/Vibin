<body onload="setTime()">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.17.1/moment.min.js"></script>
  <script
    src="https://cdnjs.cloudflare.com/ajax/libs/moment-duration-format/1.3.0/moment-duration-format.min.js"></script>

  <header id="header" class="fixed-top position-relative">
    <div class="container d-flex align-items-center justify-content-between">
      <h1 class="logo"><a href="/">Vibin'</a></h1>
      <nav class="nav-menu d-none d-lg-block">
        <ul>
          <li><a href="/dashboard/-1?page=1&limit=15">Home</a></li>
          <li><a href="/calendar">Calendar</a></li>
          <li><a href="/upload">Upload</a></li>
        </ul>
      </nav>
      <nav class="nav-menu d-none d-lg-block">
        <ul>
          <li class="drop-down">
            <% if (typeof userPhotoDef.data != "undefined") { %>
            <img src="data:image/<%=userPhotoDef.contentType%>;base64, <%=userPhotoDef.data.toString('base64')%>"
              height="40" width="40" style="border-radius: 50%;" alt="user photo">
            <% } else { %>
            <img src="<%= userPhoto %>" height="40" width="40" style="border-radius: 50%;" alt="user photo">
            <% } %>
            <ul>
              <li><a href="/users/profile">Profile</a></li>
              <li><a href="/logout">Logout</a></li>
            </ul>
          </li>
        </ul>
      </nav>
    </div>
  </header>

  <div class="videoPlayer">
    <div id="videoContainer">
      <div id="player"></div>
    </div>
    <div class="container-fluid">
      <%- include ('partials/messages') %>
      <div class="row">
        <div class="text col-sm-6 col-md-6 col-lg-6 col-xl-6">
          <h4><%= title %></h4>
          <a href="/choreographer/<%= choreographer %>"><%= choreographer %></a>
          <p><%= level[0] %></p>
        </div>
        <div class="nav-menu space col-sm-3 col-md-3 col-lg-3 col-xl-3 d-flex justify-content-around">
          <ul>

            <form action="/player/:id" method="POST">
              <% let action = '' %>
              <% for (i = 0; i < like.length; i++) { %>
              <% let id = like[i].id %>
              <% if (id.includes(ObjID)) { %>
              <% action = 'unlike' %>
              <% break; %>
              <% } else { %>
              <% action = 'like' %>
              <% } %>
              <% } %>
              <input type="id" id="id" name="id" value="<%= typeof id != 'undefined' ? id : '' %>" hidden />
              <input type="action" id="action" name="action" value="<%= typeof action != 'undefined' ? action : '' %>"
                hidden />
              <input class="btn btn-danger" type="submit" value="<%= action %>">
              <!-- <svg width="2.5em" height="2.5em" viewBox="0 0 16 16" class="bi bi-emoji-sunglasses" fill="currentColor"
                xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                <path fill-rule="evenodd"
                  d="M4.285 9.567a.5.5 0 0 1 .683.183A3.498 3.498 0 0 0 8 11.5a3.498 3.498 0 0 0 3.032-1.75.5.5 0 1 1 .866.5A4.498 4.498 0 0 1 8 12.5a4.498 4.498 0 0 1-3.898-2.25.5.5 0 0 1 .183-.683zM6.5 6.497V6.5h-1c0-.568.447-.947.862-1.154C6.807 5.123 7.387 5 8 5s1.193.123 1.638.346c.415.207.862.586.862 1.154h-1v-.003l-.003-.01a.213.213 0 0 0-.036-.053.86.86 0 0 0-.27-.194C8.91 6.1 8.49 6 8 6c-.491 0-.912.1-1.19.24a.86.86 0 0 0-.271.194.213.213 0 0 0-.036.054l-.003.01z" />
                <path
                  d="M2.31 5.243A1 1 0 0 1 3.28 4H6a1 1 0 0 1 1 1v1a2 2 0 0 1-2 2h-.438a2 2 0 0 1-1.94-1.515L2.31 5.243zM9 5a1 1 0 0 1 1-1h2.72a1 1 0 0 1 .97 1.243l-.311 1.242A2 2 0 0 1 11.439 8H11a2 2 0 0 1-2-2V5z" />
              </svg> -->
            </form>

            <li><a id="speedup" onclick="speedUp()">
                <svg width="2.5em" height="2.5em" viewBox="0 0 16 16" class="bi bi-chevron-double-up"
                  fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                  <path fill-rule="evenodd"
                    d="M7.646 2.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 3.707 2.354 9.354a.5.5 0 1 1-.708-.708l6-6z" />
                  <path fill-rule="evenodd"
                    d="M7.646 6.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1-.708.708L8 7.707l-5.646 5.647a.5.5 0 0 1-.708-.708l6-6z" />
                </svg>
              </a></li>
            <li>
              <a id="speeddown" onclick="speedDown()">
                <svg width="2.5em" height="2.5em" viewBox="0 0 16 16" class="bi bi-chevron-double-down"
                  fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                  <path fill-rule="evenodd"
                    d="M1.646 6.646a.5.5 0 0 1 .708 0L8 12.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z" />
                  <path fill-rule="evenodd"
                    d="M1.646 2.646a.5.5 0 0 1 .708 0L8 8.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z" />
                </svg>
              </a>
            </li>
            <li>
              <a id="mirror" onclick="mirrorToggle()">
                <svg width="2.5em" height="2.5em" viewBox="0 0 16 16" class="bi bi-aspect-ratio" fill="currentColor"
                  xmlns="http://www.w3.org/2000/svg">
                  <path fill-rule="evenodd"
                    d="M0 3.5A1.5 1.5 0 0 1 1.5 2h13A1.5 1.5 0 0 1 16 3.5v9a1.5 1.5 0 0 1-1.5 1.5h-13A1.5 1.5 0 0 1 0 12.5v-9zM1.5 3a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h13a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5h-13z" />
                  <path fill-rule="evenodd"
                    d="M2 4.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1H3v2.5a.5.5 0 0 1-1 0v-3zm12 7a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1 0-1H13V8.5a.5.5 0 0 1 1 0v3z" />
                </svg>
              </a>
            </li>
            <li>
              <a id="fullscreenOn" onclick="fullScreenOn()">
                <svg width="2.5em" height="2.5em" viewBox="0 0 16 16" class="bi bi-fullscreen" fill="currentColor"
                  xmlns="http://www.w3.org/2000/svg">
                  <path fill-rule="evenodd"
                    d="M1.5 1a.5.5 0 0 0-.5.5v4a.5.5 0 0 1-1 0v-4A1.5 1.5 0 0 1 1.5 0h4a.5.5 0 0 1 0 1h-4zM10 .5a.5.5 0 0 1 .5-.5h4A1.5 1.5 0 0 1 16 1.5v4a.5.5 0 0 1-1 0v-4a.5.5 0 0 0-.5-.5h-4a.5.5 0 0 1-.5-.5zM.5 10a.5.5 0 0 1 .5.5v4a.5.5 0 0 0 .5.5h4a.5.5 0 0 1 0 1h-4A1.5 1.5 0 0 1 0 14.5v-4a.5.5 0 0 1 .5-.5zm15 0a.5.5 0 0 1 .5.5v4a1.5 1.5 0 0 1-1.5 1.5h-4a.5.5 0 0 1 0-1h4a.5.5 0 0 0 .5-.5v-4a.5.5 0 0 1 .5-.5z" />
                </svg>
              </a>
            </li>
          </ul>
        </div>
        <form action="/player/:id/calendar" method="POST"
          class="col-sm-3 col-md-3 col-lg-3 col-xl-3 d-flex justify-content-center">
          <input type="id" id="id" name="id" class="form-control" placeholder="Enter The ID"
            value="<%= typeof id != 'undefined' ? id : '' %>" hidden />
          <input type="datetime-local" id="date" name="date" class="form-control">
          <button class="button" type="submit">Add</button>
        </form>
      </div>
    </div>

    <div class="container">
      <nav class="navbar fixed-bottom navbar-dark bg-light justify-content-center">
        <ul>
          <li class="active"><a href="/dashboard/-1?page=1&limit=15">
              <svg width="1.5em" height="1.5em" viewBox="0 0 16 16" class="bi bi-house" fill="currentColor"
                xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd"
                  d="M2 13.5V7h1v6.5a.5.5 0 0 0 .5.5h9a.5.5 0 0 0 .5-.5V7h1v6.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5zm11-11V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z" />
                <path fill-rule="evenodd"
                  d="M7.293 1.5a1 1 0 0 1 1.414 0l6.647 6.646a.5.5 0 0 1-.708.708L8 2.207 1.354 8.854a.5.5 0 1 1-.708-.708L7.293 1.5z" />
              </svg>
            </a>Home</li>
          <li><a href="/calendar">
              <svg width="1.5em" height="1.5em" viewBox="0 0 16 16" class="bi bi-calendar-plus" fill="currentColor"
                xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd"
                  d="M8 7a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.5.5H6a.5.5 0 0 1 0-1h1.5V7.5A.5.5 0 0 1 8 7z" />
                <path fill-rule="evenodd" d="M7.5 9.5A.5.5 0 0 1 8 9h2a.5.5 0 0 1 0 1H8.5v1.5a.5.5 0 0 1-1 0v-2z" />
                <path fill-rule="evenodd"
                  d="M1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1zm1-3a2 2 0 0 0-2 2v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2H2z" />
                <path fill-rule="evenodd"
                  d="M3.5 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5zm9 0a.5.5 0 0 1 .5.5V1a.5.5 0 0 1-1 0V.5a.5.5 0 0 1 .5-.5z" />
              </svg>
            </a>Calendar</li>
          <li><a href="/upload">
              <svg width="1.5em" height="1.5em" viewBox="0 0 16 16" class="bi bi-upload" fill="currentColor"
                xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd"
                  d="M.5 8a.5.5 0 0 1 .5.5V12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V8.5a.5.5 0 0 1 1 0V12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V8.5A.5.5 0 0 1 .5 8zM5 4.854a.5.5 0 0 0 .707 0L8 2.56l2.293 2.293A.5.5 0 1 0 11 4.146L8.354 1.5a.5.5 0 0 0-.708 0L5 4.146a.5.5 0 0 0 0 .708z" />
                <path fill-rule="evenodd" d="M8 2a.5.5 0 0 1 .5.5v8a.5.5 0 0 1-1 0v-8A.5.5 0 0 1 8 2z" />
              </svg>
            </a>Upload</li>
          <li><a href="/users/profile">
              <svg width="1.5em" height="1.5em" viewBox="0 0 16 16" class="bi bi-file-person" fill="currentColor"
                xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd"
                  d="M4 1h8a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2zm0 1a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1H4z" />
                <path d="M13.784 14c-.497-1.27-1.988-3-5.784-3s-5.287 1.73-5.784 3h11.568z" />
                <path fill-rule="evenodd" d="M8 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" />
              </svg>
            </a>User</li>
        </ul>
      </nav>
    </div>
</body>

<script>
  var tag = document.createElement('script');

  tag.src = "https://www.youtube.com/iframe_api";
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

  var player;
  function onYouTubeIframeAPIReady() {
    player = new YT.Player('player', {
      videoId: '<%= id %>',
      height: '100%',
      width: '100%',
      playerVars: {
        rel: 0,
        playsinline: 1,
        modestbranding: 1,
        showinfo: 0
      }
    });
  }

  function speedUp() {
    let rate = player.getPlaybackRate();
    player.setPlaybackRate(rate + 0.25);
  }

  function speedDown() {
    let rate = player.getPlaybackRate();
    player.setPlaybackRate(rate - 0.25);
  }

  function mirrorToggle() {
    document.getElementById("player").classList.toggle("mirror");
  }

  function fullScreenOn() {
    if (document.getElementById("player").style.height === "100vh") {
      document.getElementById("header").hidden = false;
      document.getElementById('videoContainer').style.height = '75vh';
      document.getElementById('player').style.height = '75vh';
    } else {
      document.getElementById("header").hidden = true;
      document.getElementById('videoContainer').style.height = '100vh';
      document.getElementById('player').style.height = '100vh';
    }
  }

  function setTime() {
    moment().format('YYYY-MM-DDThh:mm');
    document.getElementById("date").setAttribute("min", moment().format('YYYY-MM-DDThh:mm'))
  }

</script>
<style>
  .mirror {
    transform: rotateY(180deg);
    -webkit-transform: rotateY(180deg);
    -moz-transform: rotateY(180deg);
  }

  .fullscreen {
    width: 100%;
    height: 100vh;
  }
</style>